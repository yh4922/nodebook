<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-3d96627c-afa1-4fd1-aa08-294d236565c2"></attachment><p><br></p><attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-60d18719-bd2d-48f9-91ff-53edf540ecd3"></attachment><h1>1.安装 think-websocket 和 think-websocket-ws 库</h1><pre class="ql-syntax" spellcheck="false">npm install --save think-websocket-ws
yarn add think-websocket-ws

npm install --save think-websocket
yarn add think-websocket
</pre><h1>2.在文件 <span style="color: rgb(204, 232, 204); background-color: rgb(102, 185, 102);">src/config/adapter.js</span> 中配置连接</h1><pre class="ql-syntax" spellcheck="false">// 调用think-websocket-ws库
const ws = require('think-websocket-ws');

/**
 * websocket配置
 * websocket adapter config
 * @type {Object}
 */
exports.websocket = {
  type: 'ws',
  common: {},
  ws: {
    handle: ws,
    path: '/ws',  
    messages: [{
      open: '/socketio/open', // 链接打开
      /*socket事件对应的控制器*/
    }]
  }
}
</pre><h1>3.在文件 <span style="background-color: rgb(102, 185, 102); color: rgb(204, 232, 204);">src/config/extent.js</span> 中添加扩展</h1><pre class="ql-syntax" spellcheck="false">const websocket = require('think-websocket');

module.exports = [
  websocket(think.app),
];
</pre><h1>4.创建在 <span style="color: rgb(204, 232, 204); background-color: rgb(102, 185, 102);">controller </span>文件下创建控制器</h1><pre class="ql-syntax" spellcheck="false">module.exports = class extends think.Controller {
  constructor(...arg) {
    super(...arg)
  }
  async openAction () {
    var data = this.wsData.data
    this.emit()
    return this.success()
  }
}
</pre><p><br></p>